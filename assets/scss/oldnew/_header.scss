/*! Copyright 2007-2020 Daniel F. Dickinson <cshored@thecshore.com>
 *  Released under the Creative Commons BY (Attribution) 4.0 License
 */
// OldNewMashup Theme Page Header Styling

// ########################################################################

// Mixins - sub-'functions'

// ########################################################################

@import 'page-header/search';
@import 'page-header/menubar';
@import 'page-header/hamburger-trigger';
@import 'page-header/site-badge';

@mixin top-bar-contents($device-capabilities: 'all-browsers', $sub-devcap: null) {
  @include site-badge($device-capabilities, $sub-devcap);
  @include top-bar-start($device-capabilities, $sub-devcap);
  @include menubar-site-menu($device-capabilities, $sub-devcap);
  @include top-bar-search($device-capabilities, $sub-devcap);
  @include top-bar-search-results($device-capabilities, $sub-devcap);
}

@mixin top-bar-off-canvas($device-capabilities: 'small-screen') {
  background-color: $default-top-bar-background-color;

  @supports (background-color: transparent) {
    background-color: transparent;
  }

  color: $hamburger-top-bar-menu-text-color;
  height: $top-bar-off-canvas-height;
  left: 0;
  margin: 0;
  overflow: auto;
  overflow-y: scroll;
  padding: 0;
  position: fixed;
  top: 0;
  visibility: hidden;
  width: $top-bar-off-canvas-width;
  z-index: $hamburger-top-bar-z-index;
}

@mixin top-bar($device-capabilities: 'all-browsers', $sub-devcap: null) {
  @if $device-capabilities == 'all-browsers' {

    @include top-bar-contents($device-capabilities, $sub-devcap);

    & .top-bar {
      display: block; // So children can be visible
      height: 0;
      overflow: visible; // So children can be visible
      visibility: hidden;
      width: 0;
      z-index: 0;
    }
  } @else {
    & .top-bar {
      @if $device-capabilities == 'small-screen' {
        @include top-bar-off-canvas($device-capabilities);
        @include top-bar-contents($device-capabilities, $sub-devcap);
      } @elseif $device-capabilities == 'normal-plus-screen' {
        @include top-bar-contents($device-capabilities, $sub-devcap);

        height: $hamburger-top-bar-height;
        overflow: visible;
        position: relative;
        visibility: visible;
        width: 100%;
        z-index: $flyout-z-index;
      } @elseif $device-capabilities == 'no-hover' {
        @include top-bar-off-canvas($device-capabilities);
        @include top-bar-contents($device-capabilities, $sub-devcap);
      } @elseif $device-capabilities == 'speech' {
        @include site-badge($device-capabilities);
        @include menubar-site-menu($device-capabilities, $sub-devcap);
        @include menubar-site-menu-active($device-capabilities, true);

        visibility: visible;

        & .top-search {
          display: none;
          visibility: hidden;
        }

        & .search-results {
          display: none;
          visibility: hidden;
        }
      } @elseif $device-capabilities == 'print' {
        @include site-badge($device-capabilities);

        visibility: visible;

        & .menubar-site-menu {
          display: none;
          visibility: hidden;
        }

        & .top-search {
          display: none;
          visibility: hidden;
        }

        & .search-results {
          display: none;
          visibility: hidden;
        }
      }
    }
  }
}

@mixin header-wrapper-mq($device-capabilities: 'small-screen', $sub-devcap: null) {
  display: block;
  height: auto;
  visibility: visible;
  width: 100%;

  @if $sub-devcap == 'ie11+' {
    display: flex;
    flex: 1 1 100%;
    grid-column: initial;
    grid-row: initial;
    order: 1;
    width: auto;
  }

  @supports (not (display: grid)) and (display: flex) {
    display: flex;
    flex: 1 1 100%;
    order: 1;
    width: auto;
  }

  @supports (display: grid) {
    grid-column-end: 3;
    grid-column-start: 1;
    grid-row-start: 1;
    position: relative;
    width: auto;
  }
}

@mixin page-header($device-capabilities: 'all-browsers', $sub-devcap: null) {

  .header-wrapper {
    @include top-bar-trigger($device-capabilities, $sub-devcap);
    @include top-bar($device-capabilities, $sub-devcap);
    @include top-bar-overlay($device-capabilities, $sub-devcap);

    @if $device-capabilities == 'all-browsers' {
      left: 0;
      overflow: visible;
      position: relative;
      top: 0;
      visibility: hidden;
      width: 100%;
      z-index: $hamburger-top-bar-z-index;
    } @elseif $device-capabilities == 'small-screen' {
      @include header-wrapper-mq($device-capabilities, $sub-devcap);
    } @elseif $device-capabilities == 'normal-plus-screen' {
      @include header-wrapper-mq($device-capabilities, $sub-devcap);
    } @elseif $device-capabilities == 'no-hover' {
      @include header-wrapper-mq($device-capabilities, $sub-devcap);
    } @elseif $device-capabilities == 'speech' {
      @supports (order: 4) {
        flex: 1 1 100%;
        height: auto;
        order: 4;
        visibility: visible;
        width: auto;
      }
    } @elseif $device-capabilities == 'print' {
      display: none;
      visibility: hidden;
    }
  }
}
