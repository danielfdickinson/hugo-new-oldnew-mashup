/*! Copyright 2020 Daniel F. Dickinson <cshored@thecshore.com>
 *  Released under the Creative Commons BY (Attribution) 4.0 License
 */

// OldNew Mashup Theme CSS3 Device Capability Selection

// This is were the CSS actually exists from the point of view of the
// browser

// sass-lint:disable no-vendor-prefixes

// ########################################################################

// Top-level mixin - everything else is called as a mixin from this mixin
// WIP: Not yet true except for header

// ########################################################################

@mixin top-level-css($is-desktop: null, $is-older-browser: null, $is-ie9-plus: null, $is-ie11: null, $is-edge12-plus: null, $has-screen-mq: null, $has-speech-mq: null, $has-print-mq: null, $has-no-hover-mq: null) {

  @include page-header($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

  @if $is-older-browser == false {
    * {
      box-sizing: border-box;
    }
  } @else if $is-older-browser == true {
    * {
      box-sizing: content-box;
    }
  }

  @if $is-ie9-plus == true { // ie9+
    & * {
      box-sizing: border-box;
    }
  }

  // Applied to all browsers
  .back-to-top-button {
    background-color: $hamburger-start-background-color;
    bottom: 0;
    display: block;
    height: $hamburger-top-bar-height;
    line-height: $hamburger-top-bar-height;
    position: fixed;
    right: 0;
    text-align: center;
    width: $hamburger-top-bar-width;

    @supports (opacity: .5) {
      opacity: .5;
    }

    & a {
      &:link {
        display: block;
        height: 100%;
        text-decoration: none;
        width: 100%;
      }
    }

    & span {
      color: $default-inline-pre-text-color;
      vertical-align: middle;
    }

    @supports (border-radius: 12px) {
      border-radius: 12px;

      a {
        &:link,
        &:hover,
        &:active {
          border-radius: 12px;
        }
      }
    }

    @if $is-ie11 == true {
      border-radius: 12px;

      a {
        &:link,
        &:hover,
        &:active {
          border-radius: 12px;
        }
      }
    }
  }

  @if $has-speech-mq == true {
    .header-wrapper {
      order: 4;

      .site-badge {

        .graphics-row {
          display: none;
        }

        .site-id {
          display: none;
        }

        &::before {
          content: 'Landing Page for OldNew Mashup';
        }
      }
    }

    .back-to-top-button {
      display: none;
      visibility: hidden;
    }
  }

  @if $has-print-mq == true {
    .back-to-top-button {
      display: none;
      visibility: hidden;
    }
  }
}


// ########################################################################

// Where the CSS actually lives from the browser's point of view
// This is where the SCSS computer puts the compiled CSS

// ########################################################################

// NOTE: Each later top-level-css must override settinsg from this
// top-level-css because the top-level-css is created at compile time but
// but the media queries are applied at runtime.

// Base CSS - Applied to all browsers (including printing and screen readers)
// desktop, old-browser
@include top-level-css(true, true);

// Hide from really old browsers (depends on old browser CSS being
// applied first)
// We assume the browsers that can answer MQ but aren't big 'enough' are
// older mobile devices
// We only apply screen styles here despite the 'all'
// Any browser capable of understanding media queries must override these
// styles if they are not appropriate
@media only all {
  // mobile, newer-browser
  @include top-level-css(false, false);
}

// If the screen is big enough and browser recognizes media queries,
// We assume desktop and newer browser
// Is screen only
// Must be overridden by any device with a big enough screen, including
// devices without hover (i.e. mobile)
@media only screen and (min-height: 36em) and (min-width: 50em) {
  @include top-level-css(true, false, null, null, null, true); // desktop, newer-browser, not ie9+, not ie11
}

// IE9+ media block hack from https://keithclark.co.uk/articles/moving-ie-specific-css-into-media-blocks/media-tests/
// Screen only
@media screen and (min-width:0\0) { // sass-lint:disable-line space-after-colon
  @include top-level-css(true, false, true);
  // desktop,newer-browser, ie9+, not ie11
}

// IE11 specific media block hack
// Screen only
@media only screen and (-ms-high-contrast: none) {
  @include top-level-css(true, false, null, true);
  // desktop, newer-browser, not ie9+, is ie11
}

// MS Edge 12+ @supports hack
@supports (-ms-ime-align: auto) {
  @include top-level-css(true, false, null, null, true);
}

// Mobile: requires Media Query 4 or earlier adoption
// No hover and can answer really new media query is assumed to be newer
// mobile device
// Screen only
@media only screen and (hover: none) {
  @include top-level-css(false, false, null, null, null, true, null, null, true);
}

// Speech only
@media speech {
  @include top-level-css(null, null, null, null, null, null, true);
}

// Print only
@media speech {
  @include top-level-css(null, null, null, null, null, null, null, true);
}

@media not speech {
  html {
    font-size: 16px;
  }
}

@media screen and (min-width: 28em) {
  html {
    font-size: 17px;
  }
}

@media screen and (min-width: 36em) {
  html {
    font-size: 18px;
  }
}

@media screen and (min-width: 48em) {
  html {
    font-size: 19px;
  }
}

@media screen and (min-width: 56em) {
  html {
    font-size: 20px;
  }
}

@media screen and (min-width: 64em) {
  html {
    font-size: 21px;
  }
}
