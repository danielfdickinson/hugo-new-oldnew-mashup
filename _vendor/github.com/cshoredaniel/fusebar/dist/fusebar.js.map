{"version":3,"file":"fusebar.js","sources":["../src/index.js"],"sourcesContent":["/* global indexurl Fuse */\n\nvar summaryInclude = 1000\nvar fuseOptions = { // See Fuse.js for details\n  distance: 1000,\n  findAllMatches: true,\n  shouldSort: true,\n  includeMatches: true,\n  minMatchCharLength: 1,\n  threshold: 0.5,  // default of 0.6 matches too much\n  tokenize: false,\n  keys: [{\n    name: 'title',\n    weight: 0.3\n  },\n  {\n    name: 'content',\n    weight: 0.4\n  },\n  {\n    name: 'tags',\n    weight: 0.1\n  },\n  {\n    name: 'categories',\n    weight: 0.1\n  }\n  ]\n}\n\nfunction doCloseSearch() { // eslint-disable-line no-unused-vars\n  if (document.getElementById('search-results')) {\n    document.getElementById('search-results').style = 'display: none; visibility: hidden;'\n    document.getElementById('search-results').innerHTML = '<h2>Search Results</h2>'\n  }\n}\n\nfunction doSearch() { // eslint-disable-line no-unused-vars\n  var searchQuery = document.search_form.s.value\n  if (searchQuery) {\n    if (document.getElementById('search-query')) {\n      document.getElementById('search-results').innerHTML = '<h2>Search Results</h2>'\n\n      document.getElementById('search-results').style = 'display: block; visibility: visible;'\n      var searchFuseOptions = fuseOptions\n      searchFuseOptions.minMatchCharLength = searchQuery.length * 0.8\n      executeSearch(searchQuery, searchFuseOptions)\n    }\n  } else {\n    var para = document.createElement('p')\n    para.innerText = 'Please enter a word or phrase above'\n    if (document.getElementById('search-results')) {\n      document.getElementById('search-results').appendChild(para)\n      document.getElementById('search-results').style = 'display: block; visibility: visible;'\n    }\n  }\n  return false\n}\n\nfunction executeSearch(searchQuery, searchFuseOptions) {\n  var request = new XMLHttpRequest()\n  request.open('GET', indexurl, true)\n  request.onload = function () {\n    if (request.status >= 200 && request.status < 400) {\n      var jsonprep = request.responseText.replace(/$/, ' ')\n      var pages = JSON.parse(jsonprep)\n      var fuse = new Fuse(pages, searchFuseOptions)\n      var result = fuse.search(searchQuery)\n      if (result.length > 0) {\n        populateResults(result, searchQuery)\n      } else {\n        var para = document.createElement('p')\n        para.innerHTML = 'No matches found'\n        document.getElementById('search-results').appendChild(para)\n      }\n    } else {\n      console.log('fusebar had error ' + request.status + ' on ' + indexurl)\n    }\n  }\n  request.onerror = function () {\n    console.log('fusebar search connection error ' + request.status)\n  }\n  request.send()\n}\n\nfunction createMark(value) {\n  var markel = document.createElement('mark')\n  var spanel = document.createElement('span')\n  spanel.setAttribute('class', 'mark')\n  spanel.innerHTML = value\n  markel.appendChild(spanel)\n\n  return markel\n}\n\nfunction markMatches(matches) {\n  var newResult = {}\n  matches.forEach(function (items, num) { // eslint-disable-line no-unused-vars\n    var newElement = document.createElement('div')\n\n    var prevIndexEnd = 0\n\n    items.indices.forEach(function (indexpair, indexnum) { // eslint-disable-line no-unused-vars\n      if (items.key == 'content' && items.value.length > summaryInclude) {\n        items.value = items.value.substring(0, summaryInclude)\n      }\n\n      var matchString = items.value.substring(indexpair[0], indexpair[1] + 1)\n      if (indexpair[0] >= prevIndexEnd) {\n        var newSubString = document.createElement('span')\n        newSubString.innerHTML = items.value.substring(prevIndexEnd, indexpair[0])\n        newElement.appendChild(newSubString)\n      }\n\n      newElement.appendChild(createMark(matchString))\n\n      prevIndexEnd = indexpair[1] + 1\n    })\n\n    if ((prevIndexEnd) < items.value.length) {\n      newElement.appendChild(\n        document.createTextNode(\n          items.value.substring(prevIndexEnd, items.value.length)\n        )\n      )\n    }\n\n    newResult[items.key] = {\n      'element': newElement,\n      'original_value': items.value\n    }\n  })\n\n  return newResult\n}\n\nfunction populateResults(results, searchQuery) { // eslint-disable-line no-unused-vars\n  results.forEach(function (result, resnum) { // eslint-disable-line no-unused-vars\n    var resultElement = document.createElement('div')\n    resultElement.setAttribute('class', 'search-result')\n    resultElement.id = 'search-result-' + resnum.toString()\n    if (result.item.content && result.item.content.length > summaryInclude) {\n      result.item.content = result.item.content.substring(0, summaryInclude)\n    }\n    var resultMap = markMatches(result.matches)\n    var resultKeys = ['Title', 'Content', 'Tags', 'Categories']\n    resultKeys.forEach(function (key) {\n\n      var lowerKey = key.toString().toLowerCase()\n      var keyElement\n      var resultTitleLink\n\n      if (lowerKey == 'title') {\n        keyElement = document.createElement('h4')\n        keyElement.setAttribute('class', 'search-result-title')\n        resultTitleLink = document.createElement('a')\n        resultTitleLink.setAttribute('href', result.item.permalink)\n      }\n\n      if (typeof resultMap[lowerKey] !== 'undefined') {\n        if (lowerKey == 'title') {\n          resultTitleLink.innerHTML = resultMap[lowerKey].element.innerHTML\n          if (!resultMap[lowerKey].element.innerHTML || resultMap[lowerKey].element.innerHTML == '') {\n            resultTitleLink.innnerHTML = 'Untitled'\n          }\n        } else if (lowerKey == 'content') {\n          keyElement = resultMap.content.element\n          keyElement.setAttribute('class', 'search-result-content')\n        } else {\n          var keyElVal\n          keyElement = document.createElement('div')\n          keyElement.setAttribute('class', 'search-result-' + lowerKey)\n          keyElement.appendChild(document.createTextNode(key + ':  '))\n          var firstVal = true\n          result.item[lowerKey].forEach(function (tcval, tckey) { // eslint-disable-line no-unused-vars\n            if (!firstVal) {\n              keyElement.appendChild(document.createTextNode(', '))\n            } else {\n              firstVal = false\n            }\n            if (tcval == resultMap[lowerKey].original_value) {\n              keyElVal = document.createElement('span')\n              keyElVal.innerHTML = resultMap[lowerKey].element.innerHTML\n\n            } else {\n              keyElVal = document.createElement('span')\n              keyElVal.innerHTML = tcval\n            }\n\n            keyElement.appendChild(keyElVal)\n          })\n        }\n      } else {\n        if (lowerKey == 'title') {\n          resultTitleLink.innerHTML = result.item.title\n          if (!result.item.title || result.item.title == '') {\n            resultTitleLink.innerHTML = 'Untitled'\n          }\n        } else if (lowerKey == 'content') {\n          if (result.item.content && (result.item.content != '')) {\n            keyElement = document.createElement('div')\n            keyElement.innerHTML = result.item.content\n          }\n        } else if (result.item[lowerKey]) {\n          keyElement = document.createElement('div')\n          keyElement.setAttribute('class', 'search-result-' + lowerKey)\n          keyElement.appendChild(document.createTextNode(key + ':  '))\n          firstVal = true\n          result.item[lowerKey].forEach(function (tcval, tckey) { // eslint-disable-line no-unused-vars\n            if (!firstVal) {\n              keyElement.appendChild(document.createTextNode(', '))\n            } else {\n              firstVal = false\n            }\n            var keyElVal = document.createElement('span')\n            keyElVal.innerHTML = tcval\n            keyElement.appendChild(keyElVal)\n          })\n        }\n      }\n\n      if (lowerKey == 'title') {\n        keyElement.appendChild(resultTitleLink)\n      }\n\n      if (typeof keyElement !== 'undefined') {\n        resultElement.appendChild(keyElement)\n      }\n    })\n\n    document.getElementById('search-results').appendChild(resultElement)\n  })\n\n  return true\n}\n\nexport {\n  doCloseSearch,\n  doSearch,\n  executeSearch,\n  createMark,\n  markMatches,\n  populateResults\n}\n"],"names":["summaryInclude","fuseOptions","distance","findAllMatches","shouldSort","includeMatches","minMatchCharLength","threshold","tokenize","keys","name","weight","doCloseSearch","document","getElementById","style","innerHTML","doSearch","searchQuery","search_form","s","value","searchFuseOptions","length","executeSearch","para","createElement","innerText","appendChild","request","XMLHttpRequest","open","indexurl","onload","status","jsonprep","responseText","replace","pages","JSON","parse","fuse","Fuse","result","search","populateResults","console","log","onerror","send","createMark","markel","spanel","setAttribute","markMatches","matches","newResult","forEach","items","num","newElement","prevIndexEnd","indices","indexpair","indexnum","key","substring","matchString","newSubString","createTextNode","results","resnum","resultElement","id","toString","item","content","resultMap","resultKeys","lowerKey","toLowerCase","keyElement","resultTitleLink","permalink","element","innnerHTML","keyElVal","firstVal","tcval","tckey","original_value","title"],"mappings":"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"}