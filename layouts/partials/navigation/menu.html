<!-- Copyright 2018-2019 Daniel F. Dickinson,
     Released under the Creative Commons 4.0 BY (Attribution) License -->
{{ $curNode := . }}
{{ $nodes := ( slice . ) }}
{{ if .Parent }}
  {{ if (and .IsPage (and .Parent .Parent.Parent) ) }}
    {{ $nodes = ( slice .Parent ) }}
  {{ end }}
{{ end }}
{{ if $nodes }}
  {{ $nodesIncluded := (partial "generic-site-menu/nodes-included" ( dict "nodes" $nodes "menu_node" . "menu_type" "section-nav" ) ) }}
  {{ if $nodesIncluded }}
    <div class="section-nav-sitemap-wrapper">
      <nav id="section-nav-site-menu" class="section-nav-sitemap">
      <h2>Navigation Menu</h2>
      <ul class="sitemap-list">
      <!-- Copyright 2018-2019 Daniel F. Dickinson,
           Released under the Creative Commons 4.0 BY (Attribution) License -->
    {{ range $nodesIncluded }}
        <li class="menu-item">
      {{ partial "generic-site-menu/menu-item" (dict "menu_node" . "cur_node" $curNode) }}
      {{ if (eq .Kind "page" ) }}
        </li>
      {{ else if (eq .Kind "section" ) }}
        <ul class="menu-parent has-submenu">
         {{ partial "generic-site-menu/menu-section" ( dict "cur_node" $curNode "menu_node" . "menu_type" "section-nav" ) }}
        </ul>
      </li>
      {{ else }}
      <!-- unknown {{ .Kind }} --></li>
      {{ end }}
    {{ end }}
      </ul></nav>
    </div>
  {{ end }}
{{ end }}
