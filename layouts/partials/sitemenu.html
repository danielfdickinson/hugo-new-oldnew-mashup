<nav class="SitebarSitemap">
<ul class="SitemapList">
  <!-- Copyright 2018 Daniel F. Dickinson,
       Released under the Creative Commons 4.0 BY (Attribution) License -->
{{ $currentPage := . }}
{{ $curItem := . }}
{{ if .Page.Params.siteMenuMaxLevel }}
  {{ .Scratch.Set "maxLevel" .Page.Params.siteMenuMaxLevel }}
{{ else if .Site.Params.siteMenuMaxLevel }}
  {{ .Scratch.Set "maxLevel" .Site.Params.siteMenuMaxLevel }}
{{ else }}
  {{ .Scratch.Set "maxLevel" 4 }}
{{ end }}
{{ $maxLevel := .Scratch.Get "maxLevel" }}
{{ $prevLevel := 0 }}
{{ .Scratch.Set "currentPage" $currentPage }}
{{ .Scratch.Set "maxLevel" $maxLevel }}
{{ range $.Site.Sections }}
  {{ .Scratch.Set "currentPage" $currentPage }}
  {{ .Scratch.Set "maxLevel" $maxLevel }}
  {{ .Scratch.Set "prevLevel" $prevLevel }}
  {{ partial "menutop" . }}
{{ end }}
</ul></nav>
