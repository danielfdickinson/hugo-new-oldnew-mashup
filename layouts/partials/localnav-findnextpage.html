{{ $curPage := . }}
{{ $curPage.Scratch.Set "match" 0 }}
{{ if .Site.Menus.site }}
  {{ $siteMenus := where .Site.Menus.site "Page" "ne" nil }}
  {{ range $siteMenus }}
    {{ $matched := $curPage.Scratch.Get "match" }}
    {{ if ne $matched 2 }}
      {{ if eq $matched 1 }}
         {{ $curPage.Scratch.Set "match" 2 }}
         <a href="{{ .URL | relURL }}">Next</a>
      {{ else }}
        {{ if eq $curPage .Page }}
          {{ $curPage.Scratch.Set "match" 1 }}
        {{ else }}
          {{ if .HasChildren }}
            {{ $children := where .Children "Page" "ne" nil }}
            {{ range $children.Reverse }}
              {{ $matchc := $curPage.Scratch.Get "matchc" }}
              {{ if ne $matchc 2 }}
                {{ if eq $matchc 1 }}
                  {{ $curPage.Scratch.Set "matchc" 2 }}
                  <a href="{{ .URL | relURL }}">Next</a>
                {{ else }}
                  {{ if eq $curPage .Page }}
                    {{ $curPage.Scratch.Set "matchc" 1 }}
                  {{ end }}
                {{ end }}
              {{ end }}
            {{ end }}
            {{ $matchc := $curPage.Scratch.Get "matchc" }}
            {{ if eq $matchc 2 }}
              {{ $curPage.Scratch.Set "match" 2 }}
            {{ end }}
          {{ end }}
        {{ end }}
      {{ end  }}
    {{ end }}
  {{ end }}
  {{ $matched := $curPage.Scratch.Get "match" }}
  {{ if ne $matched 2 }}
    Next
  {{ end }}
{{ else }}
  NoSiteMenu
{{ end }}
