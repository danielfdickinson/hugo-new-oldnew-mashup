  <!-- Copyright 2018-2019 Daniel F. Dickinson,
       Released under the Creative Commons 4.0 BY (Attribution) License -->
{{ $thisPage := .Scratch.Get "ThisPage" }}
<li class="MenuItem">
  {{ partial "menuitem" . }}
  <ul class="MenuParent">
{{ if (where .Data.Pages ".Params.notinmenu" "ne" true) }}
  {{ range (where .Data.Pages ".Params.notinmenu" "ne" true) }}
    <li class="MenuItem">
    {{ .Scratch.Set "ThisPage" $thisPage }}
    {{ partial "menuitem" . }}
   </li>
  {{ end }}
  {{ if (where .Sections ".Params.notinmenu" "ne" true) }}
    {{ range (where .Sections ".Params.notinmenu" "ne" true) }}
    {{ .Scratch.Set "ThisPage" $thisPage }}
      <li class="MenuItem">
        {{ partial "menuitem" . }}
        <ul class="MenuParent">
          {{ partial "menusectionhtml" . }}
        </ul>
      </li>
    {{ end }}
  {{ end }}
{{ else if (where .Sections ".Params.notinmenu" "ne" true) }}
  {{ range (where .Sections ".Params.notinmenu" "ne" true) }}
    {{ .Scratch.Set "ThisPage" $thisPage }}
    <li class="MenuItem">
      {{ partial "menuitem" . }}
      <ul class="MenuParent">
        {{ partial "menusectionhtml" . }}
      </ul>
    </li>
  {{ end }}
{{ end }}
</li>
