<nav class="SitebarSitemap">
<ul class="SitemapList">
  <!-- Copyright 2018 Daniel F. Dickinson,
       Released under the Creative Commons 4.0 BY (Attribution) License -->
{{ .Scratch.Set "sbHasSubmenu" true }}
{{ .Parent.Scratch.Set "sbCurrentPage" .Parent }}
{{ partial "sidebar-menuitem" .Parent }}
{{ .Scratch.Delete "sbHasSubmenu" }}
{{ .Parent.Scratch.Delete "sbCurrentPage" }}
{{ .Scratch.Set "sbCurrentPage" . }}
{{ $currentPage := . }}
{{ if .Data.Pages }}
  {{ if not .Sections }}
    {{ .Scratch.Set "sbHasSubmenu" true }}
    {{ partial "sidebar-menuitem" . }}
    {{ .Scratch.Delete "sbHasSubmenu" }}
  {{ end }}
  {{ if .Sections }}
    {{ range .Sections }}
      {{ .Scratch.Set "sbCurrentPage" $currentPage }}
      {{ .Scratch.Set "sbSections" .Sections }}
      {{ .Scratch.Set "sbHasSubmenu" true }}
      {{ partial "sidebar-menusibs" . }}
      {{ .Scratch.Delete "sbHasSubmenu" }}
      {{ .Scratch.Delete "sbSections" }}
      {{ .Scratch.Delete "sbCurrentPage" }}
    {{ end }}
  {{ else }}
    {{ partial "sidebar-menusibs" . }}
  {{ end }}
  </ul></li>
{{ else }}
  {{ .Scratch.Delete "sbHasSubmenu" }}
  {{ partial "sidebar-menuitem" . }}
{{ end }}
{{ .Scratch.Delete "sbCurrentPage" }}
</ul></li></ul></nav>
