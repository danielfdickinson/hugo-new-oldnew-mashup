  <!-- Copyright 2019 Daniel F. Dickinson,
       Released under the Creative Commons 4.0 BY (Attribution) License -->
{{ $curCtx := . }}
{{ with .menu_node }}
  {{ $nodes := .Scratch.Get "aNil" }}
  {{ if (eq . .Site.Home ) }}
    {{ $nodes = ( partial "generic-site-menu/nodes-included" ( dict "nodes" .Site.Pages "menu_node" . "menu_type" $curCtx.menu_type "trimHomeChildren" true ) ) }}
  {{ else }}
    {{ $nodes = ( partial "generic-site-menu/nodes-included" ( dict "nodes" .Pages "menu_node" . "menu_type" $curCtx.menu_type ) ) }}
  {{ end }}
  {{ range $nodes }}
    <li class="menu-item">
    {{ partial "generic-site-menu/menu-item" (dict "menu_node" . "cur_node" $curCtx.cur_node ) }}
    {{ if (eq .Kind "page" ) }}
    </li>
    {{ else if (eq .Kind "section" ) }}
      <ul class="menu-parent has-submenu">
        {{ partial "generic-site-menu/menu-section" ( dict "cur_node" $curCtx.cur_node "menu_node" . "menu_type" $curCtx.menu_type ) }}
      </ul>
    </li>
    {{ else }}
    <!-- unknown {{ .Kind }} --></li>
    {{ end }}
  {{ end }}
{{ end }}
