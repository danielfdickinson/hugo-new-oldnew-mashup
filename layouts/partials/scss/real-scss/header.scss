/*! Copyright 2007-2020 Daniel F. Dickinson
    <cshored@thecshore.com>
 *  Released under the Creative Commons BY (Attribution) 4.0 License
 */
// OldNew Mashup Theme CSS3 Header Elements

// Detect IE10 and IE11

// sass-lint:disable no-vendor-prefixes

@mixin top-bar-menu-entry-anchor($padding) {
  & a {
    &:link,
    &:visited,
    &:hover,
    &:active {
      padding-left: $padding;
    }
  }
}

@mixin mobile-top-bar-menu-entry-indented2 {
  & li {
    & .menu-entry-wrapper {
      @include top-bar-menu-entry-anchor(3em);
    }

    & li {
      & .menu-entry-wrapper {
        @include top-bar-menu-entry-anchor(4em);
      }
    }
  }
}

@mixin mobile-top-bar-menu-entry-indented {
  & li {
    & .menu-entry-wrapper {
      @include top-bar-menu-entry-anchor(1em);
    }

    & li {
      & .menu-entry-wrapper {
        & a {
          @include top-bar-menu-entry-anchor(2em);
        }
      }

      @include mobile-top-bar-menu-entry-indented2;
    }
  }
}

@mixin mobile-top-bar-active {
  height: $top-bar-off-canvas-height;
  overflow-y: scroll;
  visibility: visible;
  width: $top-bar-off-canvas-width;

  & > .top-bar-start {
    background-color: $hamburger-start-hover-background-color;
    display: block;
    height: $hamburger-top-bar-height;
    visibility: visible;
  }

  & ~ div {
    &.top-bar-overlay {
      background-color: $top-bar-off-canvas-overlay-color;
      height: 100%;
      left: 0;
      opacity: $top-bar-off-canvas-overlay-opacity;
      position: fixed;
      top: 0;
      width: 100%;
      z-index: $top-bar-off-canvas-overlay-z-index;
    }
  }
}

@mixin mobile-top-bar-trigger-checked-header {
  & + .top-bar {
    @include mobile-top-bar-active;
  }
}

@mixin mobile-top-bar-press {
  &:active {
    @include mobile-top-bar-active;
  }
}

// ########################################################################

// Mixins - sub-'functions'

// ########################################################################

@mixin top-bar-div-start-sibling-anchor($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {
  & + a {
    margin-top: 0;
  }
}

@mixin top-bar-anchor-link($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {
  & > a {
    height: $hamburger-top-bar-height;
    padding: 0;
    text-align: center;
    width: $hamburger-top-bar-width;

    &:link {
      color: $hamburger-top-bar-menu-link-color;
      display: block;
    }
  }
}

@mixin page-top-search-form($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {

  & form {
    display: inline-block;
    height: 100%;
    text-align: right;

    @supports (display: flex) {
      display: flex;
      flex-wrap: nowrap;
      justify-content: flex-end;
      text-align: left;
    }

    width: 100%;

    @supports (border-radius: 12px) {
      & input {
        border-radius: 12px;
      }
    }

    @supports (box-shadow: 4px 4px 4px $default-top-bar-box-shadow-color) {
      box-shadow: 4px 4px 4px $default-top-bar-box-shadow-color;
    }

    & input {
      border: 2px solid $default-top-bar-border-color;
      height: 100%;

      &[type='search'] {
        display: inline-block;
        width: 66%;

        @supports (flex: 1 2 5em) {
          flex: 1 2 5em;
          width: auto;
        }
      }

      &[type='submit'] {
        display: inline-block;
        max-width: 3em;
        width: 33%;

        @supports (flex: 0 1 3em) {
          flex: 0 1 3em;
          max-width: none;
          width: auto;
        }
      }
    }
  }
}

@mixin mobile-top-bar-list-submenu-list {
  & li {
    @include mobile-top-bar-menu-entry-indented;
  }

  & ul {
    & li {
      &:first-of-type {
        margin-top: .2em;
      }
    }
  }
}

@mixin page-top-search-bar($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {
  @if $is-desktop {
    @if $is-older-browser {
      // Applied to all browsers (but overrriden, in some cases, below)

      & .top-search {
        display: none;
        visibility: hidden;
      }
    } @else {
      // Applied to all browsers that support media queries

      @if not ($is-ie9-plus or $is-ie11) or $is-edge12-plus {
        & .top-search {
          @include page-top-search-form($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

          display: inline-block;
          height: $hamburger-top-bar-height;
          margin: 0;
          position: absolute;
          right: 0;
          top: 0;
          visibility: visible;
          width: 70%;

          @supports (display: flex) {
            display: flex;
            justify-content: stretch;
          }
        }
      } @else {
        &  .top-search {
          display: none;
          visibility: hidden;
        }
      }
    }
  }
}

@mixin page-top-bar-active($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {
  background-color: $default-background-color;

  @supports (background-color: transparent) {
    background-color: transparent;
  }

  display: block;
  height: auto;
  overflow: visible;
  text-align: left;
  visibility: visible;

  @if $is-desktop {
    @if not $is-older-browser {
      // Applied to all browsers that support media queries

      position: fixed;
      width: 100%;

      & > .top-bar-start {
        background-color: $hamburger-start-hover-background-color;
        height: $hamburger-top-bar-height;
        visibility: visible;
      }

      & > .site-badge {
        visibility: visible;
      }

      @if not ($is-ie9-plus or $is-ie11) or $is-edge12-plus {
        & .top-search {
          display: inline-flex;
          right: 0;
          visibility: visible;
        }
      } @else {
        & .top-search {
          display: none;
          visibility: hidden;
        }
      }

      & .top-bar-overlay {
        background-color: $default-background-color;

        @supports (background-color: transparent) {
          background-color: transparent;
        }

        height: $hamburger-top-bar-height + .2;
        left: 0;
        opacity: 1;
        position: relative;
        visibility: visible;
        z-index: 0;
      }
    }
  }
}

@mixin desktop-top-bar-trigger-checked-header($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {
  & ~ .top-bar {
    @include page-top-bar-active($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);
  }
}

@mixin menubar-submenu-hover-item-hover($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {
  & > li {
    &.menu-item {
      visibility: visible;
    }
  }
}

@mixin menubar-submenu-menu-entry-hover($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {

  & > ul {
    &.menu-parent {
      @include menubar-submenu-hover-item-hover($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

      visibility: visible;
    }
  }

  & > .menu-entry-wrapper {
    &:hover,
    &:active {
      background-color: $default-hover-background-color;
      color: $default-hover-color;
    }
  }
}

@mixin menubar-submenu-submenu-active($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {
  & > li {
    visibility: visible;
  }

  &:hover,
  &:active {
    & > li {
      visibility: visible;
    }
  }
}

@mixin menubar-menu-list-active($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {
  visibility: visible;

  & > li {
    visibility: visible;
  }

  &:hover,
  &:active {
    visibility: visible;

    & > li {
      visibility: visible;
    }
  }

  & > li {
    &:hover,
    &:active {
      @include menubar-submenu-menu-entry-hover($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

      & > ul {
        @include menubar-submenu-submenu-active($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

        visibility: visible;
      }
    }
  }
}

@mixin menubar-menu-list-active-wrapper($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {
  & ul {
    &.menubar-site-menu-list { //sass-lint:disable-line nesting-depth
      @include menubar-menu-list-active($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

      visibility: visible;
    }
  }
}

@mixin menubar-site-menu($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {
  background-color: $hamburger-top-bar-background-color;
  color: $hamburger-top-bar-menu-text-color;
  display: block;
  padding: $top-bar-link-padding;
  text-decoration: none;

  &:hover,
  &:active {
    background-color: $hamburger-top-bar-background-color;
    color: $hamburger-top-bar-menu-link-color;
  }

  & a {
    &:link {
      color: $hamburger-top-bar-menu-link-color;
    }
  }
}

@mixin menubar-needs-columns-submenu($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq, $left-position, $left-margin, $start-menu-level, $needs-overflow) {
  $submenu-selector: '&';

  @for $menu-level from $start-menu-level through $flyout-max-menu-level {
    $submenu-item-selector: '#{$submenu-selector} > li.menu-item';
    $submenu-selector: '#{$submenu-item-selector} > ul';

    $left-margin: -$left-margin;
    @if quote($left-position) != 'auto' {
      $left-position: -$left-position;
    }

    #{$submenu-selector} {
      &.menu-parent {
        display: block;
        margin: 0;
        margin-top: -4ex;
        overflow: visible;
        padding: 0;
        position: absolute;
        visibility: hidden;

        @if not $is-edge12-plus {
          left: $left-position;
          @if quote($left-position) == 'auto' {
            margin-left: $left-margin;
          }
        } @elseif not $needs-overflow {
          float: right;
          margin-left: $left-margin;
        } @else {
          float: none;
        }

        &:hover,
        &:active {
          @include menubar-submenu-hover-item-hover($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);
        }
      }
    }

    #{$submenu-item-selector} {
      &:hover,
      &:active {
        @include menubar-submenu-menu-entry-hover($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);
      }
    }
  }
}

@mixin menubar-needs-overflow($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq, $left-margin, $start-menu-level) {
  &.needs-overflow {

    @include menubar-needs-columns-submenu($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq, -$flyout-menu-item-width, -$flyout-menu-item-width, $start-menu-level, true);

    height: $flyout-menu-column-height;
    left: auto;
    margin-left: $left-margin;
    overflow: auto;
    width: $flyout-menu-column-width;
  }
}

@mixin menubar-needs-columns($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq, $left-margin, $start-menu-level) {

  @include menubar-needs-columns-submenu($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq, -$flyout-menu-item-width, -$flyout-menu-item-width, $start-menu-level, false);

  height: $flyout-menu-column-height;
  left: auto;
  margin-left: $left-margin;
  overflow: auto;
  width: $flyout-menu-column-width;

  @supports (column-width: $flyout-menu-item-width) {
    @include menubar-needs-columns-submenu($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq, auto, $left-margin, $start-menu-level, false);

    @include menubar-needs-overflow($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq, $left-margin, $start-menu-level);

    height: $flyout-menu-column-height;
    left: $left-margin;
    margin: 0;
    margin-top: -4ex;
    overflow: visible;
    top: auto;
    width: auto;

    &:not(.needs-overflow) {
      column-fill: auto;
      column-gap: 0;
      column-width: $flyout-menu-item-width;
    }
  }

  @if $is-ie11 {
    @include menubar-needs-columns-submenu($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq, auto, $left-margin, $start-menu-level, false);

    @include menubar-needs-overflow($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq, $left-margin, $start-menu-level);

    height: $flyout-menu-column-height;
    left: $left-margin;
    margin: 0;
    margin-top: -4ex;
    overflow: visible;
    top: auto;
    width: auto;

    &:not(.needs-overflow) {
      column-fill: auto;
      column-gap: 0;
      column-width: $flyout-menu-item-width;
    }
  }
}

@mixin menubar-submenu($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {

  $submenu-selector: '&';
  $left-margin: -100%;
  $submenu-background-color: $flyout-submenu-colors-0;

  @for $menu-level from 1 through $flyout-max-menu-level {
    $submenu-item-selector: '#{$submenu-selector} > li';
    $submenu-selector: '#{$submenu-item-selector} > ul';
    $left-margin: -$left-margin;
    $submenu-color-number: (($menu-level + 2) % 3);

    @if $submenu-color-number == 0 {
      $submenu-background-color: $flyout-submenu-colors-0;
    } @elseif $submenu-color-number == 1 {
      $submenu-background-color: $flyout-submenu-colors-1;
    } @else {
      $submenu-background-color: $flyout-submenu-colors-2;
    }

    #{$submenu-selector} {
      &.menu-parent {
        background-color: $submenu-background-color;
        display: block;
        left: $left-margin;
        margin: 0;
        margin-top: -4ex;
        overflow: visible;
        padding: 0;
        position: absolute;
        visibility: hidden;

        &.needs-columns {
          @include menubar-needs-columns($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq, $left-margin, $menu-level);
        }

        &:hover,
        &:active {
          @include menubar-submenu-hover-item-hover($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);
        }
      }
    }

    #{$submenu-item-selector} {
      &.menu-item {
        &:hover,
        &:active {
          @include menubar-submenu-menu-entry-hover($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);
        }
      }
    }
  }
}

@mixin menubar-menu-link($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {

  @if $is-desktop {
    @if $is-older-browser {
      // Applies to all browsers

      & .menu-link {
        background-color: inherit;
        display: block;
        height: 100%;
        overflow: hidden;
        padding: .4em;
        text-overflow: ellipsis;
        width: 100%;

        &:link,
        &:visited,
        &:hover,
        &:active {
          display: block;
          text-decoration: none;
        }

        & .menu-entry {
          overflow: hidden;
          text-overflow: ellipsis;
          white-space: nowrap;
        }
      }
    }
  }
}

@mixin menubar-menu-entry-wrapper($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {

  @if $is-desktop {
    @if $is-older-browser {
      // Applies to all browsers

      & .menu-entry-wrapper {
        @include menubar-menu-link($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

        background-color: inherit;
        display: block;
        height: 100%;
        margin: 0;
        overflow: hidden;
        padding: 0;
        text-overflow: ellipsis;
        width: 100%;
      }
    }
  }
}

@mixin menubar-site-menu-list($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {
  list-style-position: outside;
  list-style-type: none;

  @if $is-desktop {
    @if $is-older-browser {
      // Applies to all browsers

      @include menubar-menu-list-active($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

      @include menubar-submenu($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

      & {
        border-top: 0 none;
      }

      & .menu-item {
        @include menubar-menu-entry-wrapper($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);
        background-color: inherit;
        border: 2px solid $hamburger-top-bar-menu-border-color;
        display: block;
        height: $flyout-menu-item-height - .1em;
        margin: 0;
        overflow: visible;
        padding: 0;
        visibility: hidden;
        width: $flyout-menu-item-width - .3em;

        & ul {
          list-style-position: outside;
          list-style-type: none;
          visibility: hidden;
        }

        & a {
          &:link {
            color: $hamburger-top-bar-menu-link-color;
          }
        }
      }
    } @else {
      // Applies to all browsers that understand media queries

      @include menubar-submenu($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

      & .menu-item {
        @include menubar-menu-entry-wrapper($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

        height: $flyout-menu-item-height;
        width: $flyout-menu-item-width;
      }
    }
  }
}

@mixin page-header($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq) {
  @if not $is-desktop {
    // Displays on old small screen or with screens with no hover (i.e. mobile)
    // So will occur after old desktop (with no new desktop) as well as
    // as after new desktop when the screen is big enough to match desktop
    // rules.
    &.top-bar-trigger {
      cursor: pointer;
      display: block;
      height: $hamburger-top-bar-height;
      left: auto;
      @supports (opacity: 0) {
        opacity: 0;
      }
      position: fixed;
      right: 0;
      top: 0;
      width: $hamburger-top-bar-width;
      z-index: $hamburger-top-bar-z-index + 2;

      &:checked,
      &:active {
        @include mobile-top-bar-trigger-checked-header;
      }

      // &:hover {
      // Hover should have no effect on mobile (usually a touch screen)
      // @include desktop-top-bar-trigger-checked-header-undo(true);
      // }
    }

    header {
      &.top-bar {
        @supports (background-color: transparent) {
          background-color: transparent;
        }
        color: $hamburger-top-bar-menu-text-color;
        left: 0;
        margin: 0;
        overflow: hidden;
        padding: 0;
        position: fixed;
        top: 0;
        visibility: hidden;
        z-index: $hamburger-top-bar-z-index;

        & .site-menu {
          @include menubar-site-menu($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

          @include mobile-top-bar-list-submenu-list;
        }

        &:hover,
        &:active {
          @include page-top-bar-active($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);
        }
      }
    }

    div {
      &.top-bar-start {
        @include mobile-top-bar-press;

        opacity: .5;
      }

      &.top-bar-overlay {
        visibility: hidden;
      }
    }
  } @else {
    @if $is-older-browser {
      // Is applied to all browsers

      // For the case where header tag is not understood
      .header-wrapper {
        background-color: $default-background-color;

        @supports (background-color: transparent) {
          background-color: transparent;
        }

        display: block;
        height: $hamburger-top-bar-height + .2;
        left: 0;

        @supports (not (display: grid)) and (display: flex) {
          display: flex;
          flex: 1 1 100%;
          left: $hamburger-top-bar-width;
          order: 1;
        }

        overflow: visible;
        position: relative;
        top: 0;
        visibility: visible;
        width: 100%;
        z-index: $flyout-z-index;

        &:hover,
        &:active {
          & ~ .menubar-site-menu-list {
            @include menubar-menu-list-active($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);
          }
        }
      }

      .top-bar-trigger {
        @supports (background-color: transparent) {
          background-color: transparent;
        }
        display: none;
        height: 0;
        visibility: hidden;
        width: 0;
        z-index: 0;
      }

      // For the case where header tag is not understood
      .top-bar {
        background-color: $default-background-color;

        @supports (background-color: transparent) {
          background-color: transparent;
        }

        display: block;  // So children can be visible
        height: 0;
        overflow: visible;  // So children can be visible
        visibility: visible;  // So children can be visible
        width: 0;
        z-index: 0;
      }

      .top-bar-start {
        display: none;
        visibility: hidden;
      }

      // For the case where nav tag is not understood
      .menubar-site-menu {
        display: block;  // So children can be visible
        height: 0;
        overflow: visible;  // So children can be visible
        visibility: hidden;
        width: 0;
        z-index: 0;
      }

      // For the case where nav tag is not understood
      ul {
        &.menubar-site-menu-list {
          @include menubar-site-menu-list($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq)

          background-color: $default-background-color;
          border: 2px solid $menubar-top-level-border-color;
          display: block;
          left: .3em;
          margin: 0;
          overflow: visible;
          padding: 0;
          position: fixed;
          top: $hamburger-top-bar-height + .6em;
          visibility: hidden;
          width: $flyout-menu-item-width - .1em;
          z-index: $flyout-z-index;
        }
      }

      .top-search {
        display: none;
        visibility: hidden;
      }

      .top-bar-overlay {
        background-color: $default-background-color;
        display: block;
        height: $hamburger-top-bar-height + 1;
        left: 0;
        position: relative;
        top: 0;
        visibility: visible;
        width: 100%;
        z-index: 0;

        @supports (opacity: 0) {
          opacity: 0;
        }
      }

      .site-badge {
        align-content: center;
        background-color: $default-top-bar-background-color;
        border: 2px solid $default-top-bar-border-color;
        color: $default-link-color;
        display: block;
        height: $hamburger-top-bar-height;
        line-height: $hamburger-top-bar-height;
        margin: 0;
        margin-left: .2em;
        margin-top: .2em;
        max-width: $site-badge-width;
        overflow: hidden;
        padding: 0;
        position: fixed;
        visibility: visible;
        z-index: $hamburger-top-bar-z-index;

        & .graphics-row {
          background-color: $site-badge-graphic-background-color;

          display: block;
          float: left;
          height: 100%;
          max-width: $site-badge-graphic-width;
        }

        & .site-id {
          display: block;
          font-family: Georgia, serif;
          height: 100%;
          margin-left: .2em;
          max-width: $site-id-width;
          overflow: hidden;
          @supports (text-overflow: ellipsis) {
            text-overflow: ellipsis;
          }

          & span {
            display: block;
            vertical-align: middle;
          }
        }

        &:link,
        &:visited,
        &:hover,
        &:active {
          text-decoration: none;
        }

        &:hover,
        &:active {
          border: 2px inset $default-top-bar-hover-border-color;
          visibility: visible;

          .graphics-row {
            background-color: $default-background-color;

            @supports (background-color: transparent) {
              background-color: transparent;
            }
          }

          & ~ ul {
            &.menubar-site-menu-list {
              @include menubar-menu-list-active($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

              visibility: visible;
            }
          }
        }
      }

      .site-badge-graphic {
        height: 100%;
        overflow: hidden;
        padding: 0;
        text-align: center;
        width: 100%;
      }

      .search-results {
        display: none;
        visibility: hidden;
      }
    } @else {
      // applies to all browsers which understand media queries

      .top-bar-trigger {
        cursor: pointer;
        display: block;
        height: $hamburger-top-bar-height;
        left: 0;
        opacity: 0; // so it's invisible
        position: fixed;
        top: 0;
        visibility: visible; // so we can activate it
        width: $hamburger-top-bar-width;
        z-index: $hamburger-top-bar-z-index + 2;

        &:checked,
        &:hover,
        &:active {
          @include desktop-top-bar-trigger-checked-header($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);
        }
      }

      header {
        &.top-bar {
          @include page-top-search-bar($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

          color: $hamburger-top-bar-menu-text-color;
          height: $hamburger-top-bar-height;
          margin: 0;
          padding: 0;
          position: absolute;
          top: 0;
          visibility: visible;
          width: 100%;
          z-index: $hamburger-top-bar-z-index;

          &:hover,
          &:active {
            @include page-top-bar-active($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);
          }
        }
      }

      .top-bar-start {
        @include top-bar-anchor-link($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);
        @include top-bar-div-start-sibling-anchor($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);

        background-color: $hamburger-start-background-color;
        display: block;
        height: $hamburger-top-bar-height;
        left: 0;
        @supports (opacity: .5) {
          opacity: .5;
        }
        padding: 0;
        position: fixed;
        right: 0;
        text-align: center;
        visibility: visible;
        width: $hamburger-top-bar-width;
        z-index: $hamburger-top-bar-z-index + 1;
      }

      .menubar-site-menu {
        @include menubar-site-menu($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);
      }

      ul {
        &.menubar-site-menu-list {
          @include menubar-site-menu-list($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq)

          left: $hamburger-top-bar-width;
          position: absolute;
          top: $hamburger-top-bar-height;
          visibility: hidden;
          width: $flyout-menu-item-width;
        }
      }

      .site-badge {
        left: $hamburger-top-bar-width;
        position: relative;
        top: 0;
        visibility: visible;
      }

      .site-badge {
        &:hover,
        &:active {
          border: 2px inset $default-top-bar-hover-border-color;
          visibility: visible;

          & ~ .menubar-site-menu {
            @include menubar-menu-list-active-wrapper($is-desktop, $is-older-browser, $is-ie9-plus, $is-ie11, $is-edge12-plus, $has-screen-mq, $has-speech-mq, $has-print-mq, $has-no-hover-mq);
          }
        }

        @supports (text-overflow: ellipsis) {
          .site-badge {
            & .site-id {
              text-overflow: ellipsis;
            }
          }
        }
      }

      @supports (display: flex) {
        .site-badge {
          align-items: center;
          display: inline-flex;
          justify-content: stretch;
          left: 0;
          line-height: 1.15rem;
          margin: 0;
          min-width:  $site-badge-width;
          position: relative;
          text-align: left;
          top: 0;
          width: $site-badge-width;

          & .graphics-row {
            align-content: center;
            align-items: stretch;
            display: inline-flex;
            flex: 0 0 $hamburger-top-bar-width;
            float: none;
            justify-content: stretch;
            text-align: left;
            width: auto;
          }

          & .site-id {
            align-self: center;
            display: block;
            flex: 0 0 $site-id-width;
            height: auto;
            max-width: $site-id-width;
            text-align: left;
            white-space: nowrap;

            & span {
              display: inline;
              vertical-align: baseline;
            }
          }
        }
      }

      .site-badge-graphic {
        align-self: center;
        flex: 0 0 $site-badge-graphic-width;
        width: auto;
      }

      .top-bar-overlay {
        background-color: $default-background-color;

        @supports (background-color: transparent) {
          background-color: transparent;
        }

        display: block;
        left: 0;
        position: relative;
        top: 0;
        visibility: visible;
        width: 100%;
        z-index: 0;
      }

      @if not ($is-ie9-plus or $is-ie11) or $is-edge12-plus {
        // newer browsers but not IE

        .search-results {
          background-color: $search-results-background-color;
          bottom: 0;
          color: $search-results-text-color;
          max-height: 80%;
          overflow-x: hidden;
          overflow-y: auto;
          position: fixed;
          right: 0;
          width: 100%;
          z-index: 40;

          & a {
            background-color: $search-results-background-color;
            color: $search-results-link-color;

            &:link {
              color: $search-results-link-color;
            }

            &:visited {
              color: $search-results-visited-color;
            }

            &:active,
            &:hover {
              color: $search-results-hover-color;
            }
          }
        }
      }

      @supports (border-radius: 12px) {
        .site-badge {
          border-radius: 12px;

          & .graphics-row {
            border-bottom-left-radius: 12px;
          }

          &:hover,
          &:active,
          &:link,
          &:visited {
            border-radius: 12px;
          }
        }

        .top-bar-start {
          border-radius: 12px;
        }
      }

      @supports (box-shadow: 4px 4px 4px $default-top-bar-box-shadow-color) {
        .site-badge {
          box-shadow: 4px 4px 4px $default-top-bar-box-shadow-color;

          & .graphics-row {
            border-top-left-radius: 12px;
          }

          &:hover,
          &:active {
            box-shadow: 4px 4px 4px $default-top-bar-hover-box-shadow-color inset;
          }
        }
      }

      @if $is-ie11 {
        .site-badge {
          border-radius: 12px;
          box-shadow: 4px 4px 4px $default-top-bar-box-shadow-color;

          & .graphics-row {
            border-bottom-left-radius: 12px;
            border-top-left-radius: 12px;
          }

          &:hover,
          &:active,
          &:link,
          &:visited {
            border-radius: 12px;
          }

          &:hover,
          &:active {
            box-shadow: 4px 4px 4px $default-top-bar-hover-box-shadow-color inset;
          }
        }

        .top-bar-start {
          border-radius: 12px;
        }
      }

      @supports (display: grid) {
        .header-wrapper {
          grid-column-end: 1;
          grid-column-start: 3;
          grid-row-end: 1;
          grid-row-start: 1;
        }

        .site-badge {
          align-items: center;
          display: flex;
          justify-content: stretch;
          left: $hamburger-top-bar-width;
          margin: 0;
          min-width:  $site-badge-width;
          position: absolute;
          text-align: left;
          top: 0;
          width: $site-badge-width;
        }
      }
    }
  }

  @if $has-speech-mq {
    div {
      &.header-wrapper {
        @supports (flex: 1 1 100%) {
          flex: 1 1 100%;
          order: 1;
          width: initial;
        }
      }
    }
  }
}
